---
title: "World-Economic-Analysis"
output: html_document
date: "2023-05-01"
---
I will load important packages that I will use in my analysis
```{r}
library(tidyverse)
library(tidyr)
library(ggplot2)
library(GGally)

```

Load the dataset which is in comma separated value (csv)format
```{r}
mainfolder <- "C:/Users/Admin/OneDrive/Desktop/MULAA/"
  setwd(mainfolder)
gdp <- read.table(file = "GDPdata.csv", header = TRUE, sep = ",")

```

I need to have a look at the data I'm dealing with
```{r}
summary(gdp)
str(gdp)

```
I wll need to convert Agriculture columns to numeric
But first I will have to use gsub function to avoid the introductions of NAS
```{r}
gdp$Agriculture.GDP <- gsub(",", "", gdp$Agriculture.GDP)
gdp$Agriculture.GDP <- as.numeric(gdp$Agriculture.GDP)
gdp$AGR.Rank <- gsub(",", "", gdp$AGR.Rank)
gdp$AGR.Rank <- as.numeric(gdp$AGR.Rank)

```

let me get rid of incomplete entries if any
```{r}
sum(is.na(gdp))
gdp <- gdp[complete.cases(gdp), ]

```

lets check for duplicates
```{r}
which(duplicated(gdp))
```

lets see what % every sector contributes to overall gdp
```{r}
x <- sum(gdp$GDP..millions.of...)
perc <- round(c(100*sum(gdp$Agriculture.GDP/x), 100*sum(gdp$Industry)/x, 100*sum(gdp$Services)/x))
lbl <- c("Agriculture", "Industry", "Service")
lbl1 <- paste(lbl, perc, "%", sep = " ")
pie(perc, labels = lbl1, main = "Sector cotribution to overall GDP", col = rainbow(length(perc)))

```
It is clear that Service sector contributed to 68% on the overall GDP, followed by Industrial output that account 28% of the overall GDP than Agriculture with 4%

let see the top 3 economies in every sector
I will need to load some necessary packages
```{r}
top <- gdp %>%
  filter(AGR.Rank <= 3| IND.Rank <= 3| SER.Rank <= 3) %>%
  select(Country.Economy, Agriculture.GDP, Industry, Services)
top <- gather(top, sectors, output, -1)
ggplot(top, aes(x = sectors, y = output, fill = Country.Economy))+ 
  geom_bar(stat = "identity", position = "dodge")+ 
  labs(title = "Top 3 Economies In All Sectors", caption = "Kaggle Dataset")

```
From the above graph we see that in Agriculture sector, China is leading, followed by India and the USA, In the Industry sector, China is the leading economy, followed by USA and the Japan, In Service sector, USA comes first, then China and Japan at the third place.

let see the bottom economies in each sector using slice function
1.Agricultural Sector
```{r}
agri_min <- gdp %>%
  slice_min(Agriculture.GDP, n = 3)
ggplot(agri_min, aes(reorder(Country.Economy, Agriculture.GDP), Agriculture.GDP))+ 
  geom_bar(stat = "identity", fill = "green")+ 
  labs(title = "Bottom Economies", subtitle = "Agricultural Sector", 
       caption = "Kaggle Dataset", x = "Economies")
```
from the above graph, it is clear that Luxembourg produced the least output in Agriculture globally in 2017, then Qatar and then Hong Kong

2.Industrial Sector
```{r}
ind_min <- gdp %>%
  slice_min(Industry, n = 3)
ggplot(ind_min, aes(reorder(Country.Economy, Industry), Industry))+ 
  geom_bar(stat = "identity", fill = "blue")+ 
  labs(title = "Bottom Economies", subtitle = "Industry Sector", 
       caption = "Kaggle Dataset", x = "Economies")
```
From the graph of the least output in Industrial sector, Sudan was the least, following Luxembourg and then Panama. 

3.Service Sector
```{r}
ser_min <- gdp %>%
  slice_min(Services, n = 3)
ggplot(ser_min, aes(reorder(Country.Economy, Services), Services))+ 
  geom_bar(stat = "identity", fill = "orange")+ 
  labs(title = "Bottom Economies", subtitle = "Service Sector", 
       caption = "Kaggle Dataset", x = "Economies")
```
In the service sector we have DR Congo, Turkmenisatn and Tanzania as the least Economies

Now let us see which sector output among the 3 (Agriculture, Industry, and service) has been leading among the best 10 Economies of the world.
```{r}
leading_prop <- gdp%>%
  filter(Rank <= 10) %>%
 gather(sector_prop, prop, X..of.GDP, X..of.GDP.1, X..of.GDP.2)

ggplot(leading_prop, aes(x = Country.Economy, y = prop, fill = sector_prop))+ 
  geom_bar(stat = "identity", position = "dodge")+ 
  labs(title = "Top Ten Economies' Sectors", x = "Economies")+ 
  scale_color_discrete(labels = c("Agriculture", "Industry", "Service"))

```
from the graph we can see that among the 10 best economies in the world, Service output is leading in all economies, then followed by Industrial output and Agriculture contributes the least in all the top 10 economies.This is consistent in all these economies.

lets have an analysis of the G20 countries
I will start by defining the G20 nations
```{r}
G20 <- c("Argentina", "Australia", "Brazil", "Canada", "China", 
         "India", "Indonesia", "Japan", "South Korea", "Mexico", 
         "Russia", "Saudi Arabia", "South Africa", "Turkey", "United Kingdom", 
         "United States", "Austria", "Belgium", "Bulgaria", "Croatia", 
         "Cyprus", "Czechia", "Denmark", "Estonia", "Finland", "France", 
         "Germany", "Greece", "Hungary", "Ireland", "Italy", "Latvia", 
         "Lithuania", "Luxembourg", "Malta", "Netherlands", "Poland", 
         "Portugal", "Romania", "Slovakia", "Slovenia", "Spain", "Sweden")
```

I will now visualize from gdp dataset where Economies is equal to G20
```{r}
g20 <- gdp %>%
  filter(Country.Economy %in% G20, Rank <= 10)
ggplot(g20, aes(reorder(Country.Economy,-GDP..millions.of...), GDP..millions.of...))+ 
  geom_bar(stat = "identity", fill = "blue")+ 
  labs(title = "G20 Economies", caption = "Kaggle Dataset", x = "Economies") 


```
from the graph above we can see that among the top 10 Economies of G20, USA was leading, followed by China and Japan.

lets see about BRICS
```{r}
brics <- c("Brazil", "Russia", "India", "China", "South Africa")
gdp_brics <- gdp %>%
  filter(Country.Economy %in% brics)
ggplot(gdp_brics, aes(reorder(Country.Economy,-GDP..millions.of...), GDP..millions.of...))+ 
  geom_bar(stat = "identity", fill = "blue")+ 
  labs(title = "BRICS Economies 2017")
```
China is the best Economy of the Brics, followed by India and Brazil in the third place. Russia and South Africa comes in the 4th and 5th place respectively.

let us investigate on the specific sectors output for the BRICS
```{r}
gdp_brics2 <- gdp_brics %>%
  gather(sectors, outputs, Agriculture.GDP, Industry, Services)
ggplot(gdp_brics2, aes(x = Country.Economy, y = outputs, fill = sectors))+ 
  geom_bar(stat = "identity", position = "dodge")+ 
  labs(title = "BRICS Economies 2017", subtitle = "Sectors Output")
  
```
We see the same trend repeating itself, Service sector is has the most output in all, followed by Industrial and Agricultural sectors.

let now chech for correlation in the dataset.
```{r}
ggpairs(gdp, columns = c(4, 5, 8, 11))

```

Conclusion: There is a positive correlation between overall GDP and Agriculture, Industry, and Services. The correlation is strong for Industry and Services. There is a strong correlation between Agriculture ouput and Service, and between Industry and Services. However the correlation between Agriculture and Services is weak.

we can have a model explaining relationship between different aspects in our data
```{r}
gdpmodel <- lm(gdp$GDP..millions.of... ~ gdp$Agriculture.GDP + 
     gdp$Agriculture.GDP + gdp$Industry + gdp$Services)
summary(gdpmodel)
```


